<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>General Metrics &mdash; Empulse 0.0.13 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=9fc46840"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Acquisition Metrics" href="acquisition_metrics.html" />
    <link rel="prev" title="Metrics" href="metrics.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Empulse
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="metrics.html">Metrics</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">General Metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#empulse.metrics.emp"><code class="docutils literal notranslate"><span class="pre">emp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#empulse.metrics.emp_score"><code class="docutils literal notranslate"><span class="pre">emp_score()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#empulse.metrics.mp"><code class="docutils literal notranslate"><span class="pre">mp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#empulse.metrics.mp_score"><code class="docutils literal notranslate"><span class="pre">mp_score()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="acquisition_metrics.html">Acquisition Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="churn_metrics.html">Churn Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="credit_scoring_metrics.html">Credit Scoring Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="other_metrics.html">Other Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="helper_functions.html">Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Empulse</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="metrics.html">Metrics</a></li>
      <li class="breadcrumb-item active">General Metrics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/general_metrics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-empulse.metrics">
<span id="general-metrics"></span><h1>General Metrics<a class="headerlink" href="#module-empulse.metrics" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="empulse.metrics.emp">
<span class="sig-prename descclassname"><span class="pre">empulse.metrics.</span></span><span class="sig-name descname"><span class="pre">emp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_benefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_benefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_buckets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/empulse/metrics/emp.html#emp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#empulse.metrics.emp" title="Link to this definition"></a></dt>
<dd><section id="expected-maximum-profit-measure-emp">
<h2>Expected Maximum Profit Measure (EMP)<a class="headerlink" href="#expected-maximum-profit-measure-emp" title="Link to this heading"></a></h2>
<p>Compute the expected maximum profit (EMP) and the expected threshold at which the maximum profit is achieved.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl>
<dt>y_true<span class="classifier">1D array-like, shape=(n_samples,)</span></dt><dd><p>Binary target values (‘positive’: 1, ‘negative’: 0).</p>
</dd>
<dt>y_pred<span class="classifier">1D array-like, shape=(n_samples,)</span></dt><dd><p>Target scores, can either be probability estimates or non-thresholded decision values.</p>
</dd>
<dt>weighted_pdf<span class="classifier">Callable[[float, float, float, float, float, float, float, float], float]</span></dt><dd><p>Weighted probability density function (PDF) of the joint distribution of the benefits and costs.
The weighted PDF is defined as the product of the PDF and the step size of the benefits and costs.
Function takes in the following arguments:</p>
<blockquote>
<div><dl class="simple">
<dt>b0: float</dt><dd><p>Benefit for true positive prediction.</p>
</dd>
<dt>b1: float</dt><dd><p>Benefit for true negative prediction.</p>
</dd>
<dt>c0: float</dt><dd><p>Cost for false negative prediction.</p>
</dd>
<dt>c1: float</dt><dd><p>Cost for false positive prediction.</p>
</dd>
<dt>step_size_b0: float</dt><dd><p>Step size of the benefit for true positive prediction for numerical integration.
Step size is defined as (max_val - min_val) / n_buckets.
Step size is 0 if tp_benefits is a scalar.</p>
</dd>
<dt>step_size_b1: float</dt><dd><p>Step size of the benefit for true negative prediction for numerical integration.
Step size is defined as (max_val - min_val) / n_buckets.
Step size is 0 if tn_benefit is a scalar.</p>
</dd>
<dt>step_size_c0: float</dt><dd><p>Step size of the cost for false negative prediction for numerical integration.
Step size is defined as (max_val - min_val) / n_buckets.
Step size is 0 if fn_cost is a scalar.</p>
</dd>
<dt>step_size_c1: float</dt><dd><p>Step size of the cost for false positive prediction for numerical integration.
Step size is defined as (max_val - min_val) / n_buckets.
Step size is 0 if fp_cost is a scalar.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>tp_benefit<span class="classifier">float or tuple[float, float], default=0.0</span></dt><dd><p>Benefit attributed to true positive predictions.
If float, deterministic parameter defined by a scalar.
If tuple, stochastic parameter defined by an upper and lower bound.</p>
</dd>
<dt>tn_benefit<span class="classifier">float or tuple[float, float], default=0.0</span></dt><dd><p>Benefit attributed to true negative predictions.
If float, deterministic parameter defined by a scalar.
If tuple, stochastic parameter defined by an upper and lower bound.</p>
</dd>
<dt>fn_cost<span class="classifier">float or tuple[float, float], default=0.0</span></dt><dd><p>Cost attributed to false negative predictions.
If float, deterministic parameter defined by a scalar.
If tuple, stochastic parameter defined by an upper and lower bound.</p>
</dd>
<dt>fp_cost<span class="classifier">float or tuple[float, float], default=0.0</span></dt><dd><p>Cost attributed to false positive predictions.
If float, deterministic parameter defined by a scalar.
If tuple, stochastic parameter defined by an upper and lower bound.</p>
</dd>
<dt>n_buckets<span class="classifier">int, default=100</span></dt><dd><p>Number of buckets to use for the numerical integration per parameter.
Note that the computational complexity of the algorithm is exponential in the number of buckets.
For instance if you have 4 parameters with 100 buckets each, the algorithm will have to compute
the weighted PDF for 100^4 = 100_000_000 combinations.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>(emp, threshold)<span class="classifier">tuple[float, float]</span></dt><dd><p>Expected Maximum Profit and the threshold η at which the maximum profit is achieved.</p>
</dd>
</dl>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Link to this heading"></a></h3>
<p>The EMP is defined as <a href="#id26"><span class="problematic" id="id1">[1]_</span></a>:</p>
<div class="math notranslate nohighlight">
\[\int_{b_0} \int_{c_0} \int_{b_1} \int_{c_1} P(T;b_0, c_0, b_1, c_1) \cdot w(b_0, c_0, b_1, c_1) \, db_0 dc_0 db_1 dc_1\]</div>
<p>The EMP requires that the positive class is encoded as 0, and negative class as 1.
However, this implementation assumes the standard notation (‘positive’: 1, ‘negative’: 0).</p>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading"></a></h3>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Verbraken, T., Verbeke, W. and Baesens, B. (2013).
A Novel Profit Maximizing Metric for Measuring Classification
Performance of Customer Churn Prediction Models. IEEE Transactions on
Knowledge and Data Engineering, 25(5), 961-973. Available Online:
<a class="reference external" href="http://ieeexplore.ieee.org/iel5/69/6486492/06165289.pdf?arnumber=6165289">http://ieeexplore.ieee.org/iel5/69/6486492/06165289.pdf?arnumber=6165289</a></p>
</aside>
</aside>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h3>
<p>Reimplement EMPC:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">empulse.metrics</span> <span class="kn">import</span> <span class="n">emp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clv</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_benefit</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="n">clv</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="n">clv</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">f</span> <span class="o">/</span> <span class="n">clv</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_cost</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">weighted_pdf</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">b0_step</span><span class="p">,</span> <span class="n">b1_step</span><span class="p">,</span> <span class="n">c0_step</span><span class="p">,</span> <span class="n">c1_step</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">gamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">b0</span> <span class="o">+</span> <span class="n">f</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">clv</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">gamma_step</span> <span class="o">=</span> <span class="n">b0_step</span> <span class="o">/</span> <span class="p">(</span><span class="n">clv</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma_step</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emp</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">y_true</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">y_pred</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">weighted_pdf</span><span class="o">=</span><span class="n">weighted_pdf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">tp_benefit</span><span class="o">=</span><span class="n">tp_benefit</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fp_cost</span><span class="o">=</span><span class="n">fp_cost</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">n_buckets</span><span class="o">=</span><span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">(23.87559333920785, 0.8743520452740654)</span>
</pre></div>
</div>
</section>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="empulse.metrics.emp_score">
<span class="sig-prename descclassname"><span class="pre">empulse.metrics.</span></span><span class="sig-name descname"><span class="pre">emp_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_pdf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_benefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_benefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_buckets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/empulse/metrics/emp.html#emp_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#empulse.metrics.emp_score" title="Link to this definition"></a></dt>
<dd><section id="id3">
<h2>Expected Maximum Profit Measure (EMP)<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<p>Compute the expected maximum profit (EMP).</p>
<section id="id4">
<h3>Parameters<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<dl>
<dt>y_true<span class="classifier">1D array-like, shape=(n_samples,)</span></dt><dd><p>Binary target values (‘positive’: 1, ‘negative’: 0).</p>
</dd>
<dt>y_pred<span class="classifier">1D array-like, shape=(n_samples,)</span></dt><dd><p>Target scores, can either be probability estimates or non-thresholded decision values.</p>
</dd>
<dt>weighted_pdf<span class="classifier">Callable[[float, float, float, float, float, float, float, float], float]</span></dt><dd><p>Weighted probability density function (PDF) of the joint distribution of the benefits and costs.
The weighted PDF is defined as the product of the PDF and the step size of the benefits and costs.
Function takes in the following arguments:</p>
<blockquote>
<div><dl class="simple">
<dt>b0: float</dt><dd><p>Benefit for true positive prediction.</p>
</dd>
<dt>b1: float</dt><dd><p>Benefit for true negative prediction.</p>
</dd>
<dt>c0: float</dt><dd><p>Cost for false negative prediction.</p>
</dd>
<dt>c1: float</dt><dd><p>Cost for false positive prediction.</p>
</dd>
<dt>step_size_b0: float</dt><dd><p>Step size of the benefit for true positive prediction for numerical integration.
Step size is defined as (max_val - min_val) / n_buckets.
Step size is 0 if tp_benefits is a scalar.</p>
</dd>
<dt>step_size_b1: float</dt><dd><p>Step size of the benefit for true negative prediction for numerical integration.
Step size is defined as (max_val - min_val) / n_buckets.
Step size is 0 if tn_benefit is a scalar.</p>
</dd>
<dt>step_size_c0: float</dt><dd><p>Step size of the cost for false negative prediction for numerical integration.
Step size is defined as (max_val - min_val) / n_buckets.
Step size is 0 if fn_cost is a scalar.</p>
</dd>
<dt>step_size_c1: float</dt><dd><p>Step size of the cost for false positive prediction for numerical integration.
Step size is defined as (max_val - min_val) / n_buckets.
Step size is 0 if fp_cost is a scalar.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>tp_benefit<span class="classifier">float or tuple[float, float], default=0.0</span></dt><dd><p>Benefit attributed to true positive predictions.
If float, deterministic parameter defined by a scalar.
If tuple, stochastic parameter defined by an upper and lower bound.</p>
</dd>
<dt>tn_benefit<span class="classifier">float or tuple[float, float], default=0.0</span></dt><dd><p>Benefit attributed to true negative predictions.
If float, deterministic parameter defined by a scalar.
If tuple, stochastic parameter defined by an upper and lower bound.</p>
</dd>
<dt>fn_cost<span class="classifier">float or tuple[float, float], default=0.0</span></dt><dd><p>Cost attributed to false negative predictions.
If float, deterministic parameter defined by a scalar.
If tuple, stochastic parameter defined by an upper and lower bound.</p>
</dd>
<dt>fp_cost<span class="classifier">float or tuple[float, float], default=0.0</span></dt><dd><p>Cost attributed to false positive predictions.
If float, deterministic parameter defined by a scalar.
If tuple, stochastic parameter defined by an upper and lower bound.</p>
</dd>
<dt>n_buckets<span class="classifier">int, default=100</span></dt><dd><p>Number of buckets to use for the numerical integration per parameter.
Note that the computational complexity of the algorithm is exponential in the number of buckets.
For instance if you have 4 parameters with 100 buckets each, the algorithm will have to compute
the weighted PDF for 100^4 = 100_000_000 combinations.</p>
</dd>
</dl>
</section>
<section id="id5">
<h3>Returns<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>emp<span class="classifier">float</span></dt><dd><p>Expected Maximum Profit.</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Notes<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<p>The EMP is defined as <a href="#id27"><span class="problematic" id="id7">[1]_</span></a>:</p>
<div class="math notranslate nohighlight">
\[\int_{b_0} \int_{c_0} \int_{b_1} \int_{c_1} P(T;b_0, c_0, b_1, c_1) \cdot w(b_0, c_0, b_1, c_1) \, db_0 dc_0 db_1 dc_1\]</div>
<p>The EMP requires that the positive class is encoded as 0, and negative class as 1.
However, this implementation assumes the standard notation (‘positive’: 1, ‘negative’: 0).</p>
</section>
<section id="id8">
<h3>References<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Verbraken, T., Verbeke, W. and Baesens, B. (2013).
A Novel Profit Maximizing Metric for Measuring Classification
Performance of Customer Churn Prediction Models. IEEE Transactions on
Knowledge and Data Engineering, 25(5), 961-973. Available Online:
<a class="reference external" href="http://ieeexplore.ieee.org/iel5/69/6486492/06165289.pdf?arnumber=6165289">http://ieeexplore.ieee.org/iel5/69/6486492/06165289.pdf?arnumber=6165289</a></p>
</aside>
</aside>
</section>
<section id="id10">
<h3>Examples<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<p>Reimplement EMPC:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">empulse.metrics</span> <span class="kn">import</span> <span class="n">emp_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clv</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_benefit</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="n">clv</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="n">clv</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">f</span> <span class="o">/</span> <span class="n">clv</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_cost</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">weighted_pdf</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">b0_step</span><span class="p">,</span> <span class="n">b1_step</span><span class="p">,</span> <span class="n">c0_step</span><span class="p">,</span> <span class="n">c1_step</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">gamma</span> <span class="o">=</span> <span class="p">(</span><span class="n">b0</span> <span class="o">+</span> <span class="n">f</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">clv</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">gamma_step</span> <span class="o">=</span> <span class="n">b0_step</span> <span class="o">/</span> <span class="p">(</span><span class="n">clv</span> <span class="o">-</span> <span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">beta</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="o">*</span> <span class="n">gamma_step</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">emp_score</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">y_true</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">y_pred</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">weighted_pdf</span><span class="o">=</span><span class="n">weighted_pdf</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">tp_benefit</span><span class="o">=</span><span class="n">tp_benefit</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fp_cost</span><span class="o">=</span><span class="n">fp_cost</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">n_buckets</span><span class="o">=</span><span class="mi">1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
<span class="go">23.87559333920785</span>
</pre></div>
</div>
</section>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="empulse.metrics.mp">
<span class="sig-prename descclassname"><span class="pre">empulse.metrics.</span></span><span class="sig-name descname"><span class="pre">mp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_benefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_benefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/empulse/metrics/mp.html#mp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#empulse.metrics.mp" title="Link to this definition"></a></dt>
<dd><section id="maximum-profit-measure-mp">
<h2>Maximum Profit Measure (MP)<a class="headerlink" href="#maximum-profit-measure-mp" title="Link to this heading"></a></h2>
<p>Compute the maximum profit (MP) and the expected threshold at which the maximum profit is achieved.</p>
<section id="id11">
<h3>Parameters<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>y_true<span class="classifier">1D array-like, shape=(n_samples,)</span></dt><dd><p>Binary target values (‘positive’: 1, ‘negative’: 0).</p>
</dd>
<dt>y_pred<span class="classifier">1D array-like, shape=(n_samples,)</span></dt><dd><p>Target scores, can either be probability estimates or non-thresholded decision values.</p>
</dd>
<dt>tp_benefit<span class="classifier">float, default=0.0</span></dt><dd><p>Benefit attributed to true positive predictions.</p>
</dd>
<dt>tn_benefit<span class="classifier">float, default=0.0</span></dt><dd><p>Benefit attributed to true negative predictions.</p>
</dd>
<dt>fn_cost<span class="classifier">float, default=0.0</span></dt><dd><p>Cost attributed to false negative predictions.</p>
</dd>
<dt>fp_cost<span class="classifier">float, default=0.0</span></dt><dd><p>Cost attributed to false positive predictions.</p>
</dd>
</dl>
</section>
<section id="id12">
<h3>Returns<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>(mp, threshold)<span class="classifier">tuple[float, float]</span></dt><dd><p>Maximum Profit and the threshold η at which the maximum profit is achieved.</p>
</dd>
</dl>
</section>
<section id="id13">
<h3>Notes<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<p>The MP is defined as <a href="#id28"><span class="problematic" id="id14">[1]_</span></a>:</p>
<div class="math notranslate nohighlight">
\[P(T;b_0, c_0, b_1, c_1)\]</div>
<p>The MP requires that the positive class is encoded as 0, and negative class as 1.
However, this implementation assumes the standard notation (‘positive’: 1, ‘negative’: 0).</p>
</section>
<section id="id15">
<h3>References<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id16" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Verbraken, T., Verbeke, W. and Baesens, B. (2013).
A Novel Profit Maximizing Metric for Measuring Classification
Performance of Customer Churn Prediction Models. IEEE Transactions on
Knowledge and Data Engineering, 25(5), 961-973. Available Online:
<a class="reference external" href="http://ieeexplore.ieee.org/iel5/69/6486492/06165289.pdf?arnumber=6165289">http://ieeexplore.ieee.org/iel5/69/6486492/06165289.pdf?arnumber=6165289</a></p>
</aside>
</aside>
</section>
<section id="id17">
<h3>Examples<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<p>Reimplement MPC:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">empulse.metrics</span> <span class="kn">import</span> <span class="n">mp</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clv</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_benefit</span> <span class="o">=</span> <span class="n">clv</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="n">clv</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">f</span> <span class="o">/</span> <span class="n">clv</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_cost</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">tp_benefit</span><span class="o">=</span><span class="n">tp_benefit</span><span class="p">,</span> <span class="n">fp_cost</span><span class="o">=</span><span class="n">fp_cost</span><span class="p">)</span>
<span class="go">(24.708, 0.5800000000000001)</span>
</pre></div>
</div>
</section>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="empulse.metrics.mp_score">
<span class="sig-prename descclassname"><span class="pre">empulse.metrics.</span></span><span class="sig-name descname"><span class="pre">mp_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp_benefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tn_benefit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/empulse/metrics/mp.html#mp_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#empulse.metrics.mp_score" title="Link to this definition"></a></dt>
<dd><section id="id18">
<h2>Maximum Profit Measure (MP)<a class="headerlink" href="#id18" title="Link to this heading"></a></h2>
<p>Compute the maximum profit.</p>
<section id="id19">
<h3>Parameters<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>y_true<span class="classifier">1D array-like, shape=(n_samples,)</span></dt><dd><p>Binary target values (‘positive’: 1, ‘negative’: 0).</p>
</dd>
<dt>y_pred<span class="classifier">1D array-like, shape=(n_samples,)</span></dt><dd><p>Target scores, can either be probability estimates or non-thresholded decision values.</p>
</dd>
<dt>tp_benefit<span class="classifier">float, default=0.0</span></dt><dd><p>Benefit attributed to true positive predictions.</p>
</dd>
<dt>tn_benefit<span class="classifier">float, default=0.0</span></dt><dd><p>Benefit attributed to true negative predictions.</p>
</dd>
<dt>fn_cost<span class="classifier">float, default=0.0</span></dt><dd><p>Cost attributed to false negative predictions.</p>
</dd>
<dt>fp_cost<span class="classifier">float, default=0.0</span></dt><dd><p>Cost attributed to false positive predictions.</p>
</dd>
</dl>
</section>
<section id="id20">
<h3>Returns<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>mp<span class="classifier">float</span></dt><dd><p>Maximum Profit.</p>
</dd>
</dl>
</section>
<section id="id21">
<h3>Notes<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<p>The MP is defined as <a href="#id29"><span class="problematic" id="id22">[1]_</span></a>:</p>
<div class="math notranslate nohighlight">
\[P(T;b_0, c_0, b_1, c_1)\]</div>
<p>The MP requires that the positive class is encoded as 0, and negative class as 1.
However, this implementation assumes the standard notation (‘positive’: 1, ‘negative’: 0).</p>
</section>
<section id="id23">
<h3>References<a class="headerlink" href="#id23" title="Link to this heading"></a></h3>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id24" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Verbraken, T., Verbeke, W. and Baesens, B. (2013).
A Novel Profit Maximizing Metric for Measuring Classification
Performance of Customer Churn Prediction Models. IEEE Transactions on
Knowledge and Data Engineering, 25(5), 961-973. Available Online:
<a class="reference external" href="http://ieeexplore.ieee.org/iel5/69/6486492/06165289.pdf?arnumber=6165289">http://ieeexplore.ieee.org/iel5/69/6486492/06165289.pdf?arnumber=6165289</a></p>
</aside>
</aside>
</section>
<section id="id25">
<h3>Examples<a class="headerlink" href="#id25" title="Link to this heading"></a></h3>
<p>Reimplement MPC:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">empulse.metrics</span> <span class="kn">import</span> <span class="n">mp_score</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clv</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp_benefit</span> <span class="o">=</span> <span class="n">clv</span> <span class="o">*</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">d</span> <span class="o">/</span> <span class="n">clv</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">f</span> <span class="o">/</span> <span class="n">clv</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp_cost</span> <span class="o">=</span> <span class="n">d</span> <span class="o">+</span> <span class="n">f</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mp_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">tp_benefit</span><span class="o">=</span><span class="n">tp_benefit</span><span class="p">,</span> <span class="n">fp_cost</span><span class="o">=</span><span class="n">fp_cost</span><span class="p">)</span>
<span class="go">24.708</span>
</pre></div>
</div>
</section>
</section>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="metrics.html" class="btn btn-neutral float-left" title="Metrics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="acquisition_metrics.html" class="btn btn-neutral float-right" title="Acquisition Metrics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Shimanto Rahman.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>