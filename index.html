
<!DOCTYPE html>

<html data-content_root="./" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="Empulse is a scikit-learn based Python package for cost-sensitive and value-driven (also known as profit-driven) machine learning. Solve your imbalanced data and other cost-sensitive learning data science problems with a sklearn compatible library." lang="en" name="description" xml:lang="en"/>
<title>Empulse — Empulse 0.10.4 documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
<!--
    this give us a css class that will be invisible only if js is disabled
  -->
<noscript>
<style>
      .pst-js-only { display: none !important; }

    </style>
</noscript>
<!-- Loaded before other Sphinx assets -->
<link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet"/>
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet"/>
<link href="_static/pygments.css?v=8f2a1f02" rel="stylesheet" type="text/css"/>
<link href="_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="_static/sphinx-codeautolink.css?v=b2176991" rel="stylesheet" type="text/css"/>
<link href="_static/css/custom.css?v=a1165396" rel="stylesheet" type="text/css"/>
<!-- So that users can add custom icons -->
<script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" rel="preload"/>
<link as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" rel="preload"/>
<script src="_static/documentation_options.js?v=7e173fe4"></script>
<script src="_static/doctools.js?v=9bcbadda"></script>
<script src="_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="_static/clipboard.min.js?v=a7894cd8"></script>
<script src="_static/copybutton.js?v=f281be69"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
<script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://empulse.readthedocs.io/en/latest/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.10.4';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
<script src="_static/js/custom-icon.js?v=d6c5daaf"></script>
<link href="_static/favicon.ico" rel="icon"/>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="guide.html" rel="next" title="User Guide"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
<meta content="" name="docsearch:version"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<div class="skip-link d-print-none" id="pst-skip-link"><a href="#main-content">Skip to main content</a></div>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>Back to top</button>
<dialog id="pst-search-dialog">
<form action="search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" name="q" placeholder="Search the docs ..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</dialog>
<div class="pst-async-banner-revealer d-none">
<aside aria-label="Version warning" class="d-none d-print-none" id="bd-header-version-warning"></aside>
</div>
<header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
<button aria-label="Site navigation" class="pst-navbar-icon sidebar-toggle primary-toggle">
<span class="fa-solid fa-bars"></span>
</button>
<div class="navbar-header-items__start">
<div class="navbar-item">
<a class="navbar-brand logo" href="#">
<img alt="empulse homepage" class="logo__image only-light" src="_static/empulse_logo_light.png"/>
<img alt="empulse homepage" class="logo__image only-dark pst-js-only" src="_static/empulse_logo_dark.png"/>
</a></div>
</div>
<div class="navbar-header-items">
<div class="me-auto navbar-header-items__center">
<div class="navbar-item">
<nav>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="guide.html">
    User Guide
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="project_info.html">
    Project Information
  </a>
</li>
</ul>
</nav></div>
</div>
<div class="navbar-header-items__end">
<div class="navbar-item navbar-persistent--container">
<button aria-label="Search" class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
</div>
<div class="navbar-item">
<button aria-label="Color mode" class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" data-bs-placement="bottom" data-bs-title="Color mode" data-bs-toggle="tooltip">
<i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light" title="Light"></i>
<i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark" title="Dark"></i>
<i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto" title="System Settings"></i>
</button></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links">
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/ShimantoRahman/empulse" rel="noopener" target="_blank" title="GitHub"><i aria-hidden="true" class="fa-brands fa-github fa-lg"></i>
<span class="sr-only">GitHub</span></a>
</li>
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/empulse/" rel="noopener" target="_blank" title="PyPI"><i aria-hidden="true" class="fa-custom fa-pypi fa-lg"></i>
<span class="sr-only">PyPI</span></a>
</li>
</ul></div>
<div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
<button aria-controls="pst-version-switcher-list-2" aria-haspopup="listbox" aria-label="Version switcher list" class="version-switcher__button btn btn-sm dropdown-toggle" data-bs-toggle="dropdown" id="pst-version-switcher-button-2" type="button">
    Choose version  <!-- this text may get changed later by javascript -->
<span class="caret"></span>
</button>
<div aria-labelledby="pst-version-switcher-button-2" class="version-switcher__menu dropdown-menu list-group-flush py-0" id="pst-version-switcher-list-2" role="listbox">
<!-- dropdown will be populated by javascript on page load -->
</div>
</div></div>
</div>
</div>
<div class="navbar-persistent--mobile">
<button aria-label="Search" class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
</div>
<button aria-label="On this page" class="pst-navbar-icon sidebar-toggle secondary-toggle">
<span class="fa-solid fa-outdent"></span>
</button>
</div>
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<dialog id="pst-primary-sidebar-modal"></dialog>
<div class="bd-sidebar-primary bd-sidebar hide-on-wide" id="pst-primary-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-item">
<nav>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item">
<a class="nav-link nav-internal" href="guide.html">
    User Guide
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="api.html">
    API Reference
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="project_info.html">
    Project Information
  </a>
</li>
</ul>
</nav></div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-item">
<button aria-label="Color mode" class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" data-bs-placement="bottom" data-bs-title="Color mode" data-bs-toggle="tooltip">
<i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light" title="Light"></i>
<i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark" title="Dark"></i>
<i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto" title="System Settings"></i>
</button></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links">
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/ShimantoRahman/empulse" rel="noopener" target="_blank" title="GitHub"><i aria-hidden="true" class="fa-brands fa-github fa-lg"></i>
<span class="sr-only">GitHub</span></a>
</li>
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/empulse/" rel="noopener" target="_blank" title="PyPI"><i aria-hidden="true" class="fa-custom fa-pypi fa-lg"></i>
<span class="sr-only">PyPI</span></a>
</li>
</ul></div>
<div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
<button aria-controls="pst-version-switcher-list-3" aria-haspopup="listbox" aria-label="Version switcher list" class="version-switcher__button btn btn-sm dropdown-toggle" data-bs-toggle="dropdown" id="pst-version-switcher-button-3" type="button">
    Choose version  <!-- this text may get changed later by javascript -->
<span class="caret"></span>
</button>
<div aria-labelledby="pst-version-switcher-button-3" class="version-switcher__menu dropdown-menu list-group-flush py-0" id="pst-version-switcher-list-3" role="listbox">
<!-- dropdown will be populated by javascript on page load -->
</div>
</div></div>
</div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
</div>
<main class="bd-main" id="main-content" role="main">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article d-print-none"></div>
<div id="searchbox"></div>
<article class="bd-article">
<section id="empulse">
<h1>Empulse<a class="headerlink" href="#empulse" title="Link to this heading">#</a></h1>
<p>Empulse is a package aimed to enable value-driven and cost-sensitive analysis in Python.
The package implements popular value-driven and cost-sensitive metrics and algorithms
in accordance to sci-kit learn conventions.
This allows the measures to seamlessly integrate into existing ML workflows.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h2>
<p>Empulse requires python 3.10 or higher.</p>
<p>Install <code class="docutils literal notranslate"><span class="pre">empulse</span></code> via pip with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>empulse
</pre></div>
</div>
</section>
<section id="what-can-you-do-with-empulse">
<h2>What can you do with Empulse?<a class="headerlink" href="#what-can-you-do-with-empulse" title="Link to this heading">#</a></h2>
<section id="features">
<h3>Features<a class="headerlink" href="#features" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#ready-to-use-out-of-the-box-with-scikit-learn">Ready to use out of the box with scikit-learn</a></p></li>
<li><p><a class="reference internal" href="#use-case-specific-profit-and-cost-metrics">Use case specific profit and cost metrics</a></p></li>
<li><p><a class="reference internal" href="#build-your-own-profit-and-cost-metrics">Build your own profit and cost metrics</a></p></li>
<li><p><a class="reference internal" href="#various-profit-driven-and-cost-sensitive-models">Various profit-driven and cost-sensitive models</a></p></li>
<li><p><a class="reference internal" href="#easy-passing-of-instance-dependent-costs">Easy passing of instance-dependent costs</a></p></li>
<li><p><a class="reference internal" href="#cost-aware-resampling-and-relabeling">Cost-aware resampling and relabeling</a></p></li>
<li><p><a class="reference internal" href="#find-the-optimal-decision-threshold">Find the optimal decision threshold</a></p></li>
<li><p><a class="reference internal" href="#easy-access-to-real-world-datasets-for-benchmarking">Easy access to real-world datasets for benchmarking</a></p></li>
</ul>
</section>
<section id="take-the-tour">
<h3>Take the tour<a class="headerlink" href="#take-the-tour" title="Link to this heading">#</a></h3>
<section id="ready-to-use-out-of-the-box-with-scikit-learn">
<h4>Ready to use out of the box with scikit-learn<a class="headerlink" href="#ready-to-use-out-of-the-box-with-scikit-learn" title="Link to this heading">#</a></h4>
<p>All components of the package are designed to work seamlessly with scikit-learn.</p>
<p>Models are implemented as scikit-learn estimators and can be used anywhere a scikit-learn estimator can be used.</p>
<section id="pipelines">
<h5>Pipelines<a class="headerlink" href="#pipelines" title="Link to this heading">#</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/models.html#module-empulse.models" title="empulse.models"><span class="nn">empulse.models</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSLogitClassifier.html#empulse.models.CSLogitClassifier" title="empulse.models.cost_sensitive.cslogit.CSLogitClassifier"><span class="n">CSLogitClassifier</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.datasets.html#module-sklearn.datasets" title="sklearn.datasets"><span class="nn">sklearn.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.pipeline.html#module-sklearn.pipeline" title="sklearn.pipeline"><span class="nn">sklearn.pipeline</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">Pipeline</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.preprocessing.html#module-sklearn.preprocessing" title="sklearn.preprocessing"><span class="nn">sklearn.preprocessing</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">pipeline</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">Pipeline</span></a><span class="p">([</span>
    <span class="p">(</span><span class="s2">"scaler"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a><span class="p">()),</span>
    <span class="p">(</span><span class="s2">"model"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSLogitClassifier.html#empulse.models.CSLogitClassifier" title="empulse.models.cost_sensitive.cslogit.CSLogitClassifier"><span class="n">CSLogitClassifier</span></a><span class="p">())</span>
<span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline.fit" title="sklearn.pipeline.Pipeline.fit"><span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model__fp_cost</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">model__fn_cost</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cross-validation">
<h5>Cross-validation<a class="headerlink" href="#cross-validation" title="Link to this heading">#</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.model_selection.html#module-sklearn.model_selection" title="sklearn.model_selection"><span class="nn">sklearn.model_selection</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html#sklearn.model_selection.cross_val_score" title="sklearn.model_selection.cross_val_score"><span class="n">cross_val_score</span></a>

<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html#sklearn.model_selection.cross_val_score" title="sklearn.model_selection.cross_val_score"><span class="n">cross_val_score</span></a><span class="p">(</span>
    <span class="n">pipeline</span><span class="p">,</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="s2">"roc_auc"</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"model__fp_cost"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">"model__fn_cost"</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="grid-search">
<h5>Grid search<a class="headerlink" href="#grid-search" title="Link to this heading">#</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.model_selection.html#module-sklearn.model_selection" title="sklearn.model_selection"><span class="nn">sklearn.model_selection</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="sklearn.model_selection._search.GridSearchCV"><span class="n">GridSearchCV</span></a>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"model__C"</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="sklearn.model_selection._search.GridSearchCV"><span class="n">grid_search</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html#sklearn.model_selection.GridSearchCV" title="sklearn.model_selection._search.GridSearchCV"><span class="n">GridSearchCV</span></a><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">"roc_auc"</span><span class="p">)</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model__fp_cost</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">model__fn_cost</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>All metrics can easily be converted as scikit-learn scorers
and can be used in the same way as any other scikit-learn scorer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/metrics.html#module-empulse.metrics" title="empulse.metrics"><span class="nn">empulse.metrics</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.expected_cost_loss.html#empulse.metrics.expected_cost_loss" title="empulse.metrics.expected_cost_loss"><span class="n">expected_cost_loss</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.metrics.html#module-sklearn.metrics" title="sklearn.metrics"><span class="nn">sklearn.metrics</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html#sklearn.metrics.make_scorer" title="sklearn.metrics.make_scorer"><span class="n">make_scorer</span></a>

<span class="n">scorer</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html#sklearn.metrics.make_scorer" title="sklearn.metrics.make_scorer"><span class="n">make_scorer</span></a><span class="p">(</span>
    <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.expected_cost_loss.html#empulse.metrics.expected_cost_loss" title="empulse.metrics.expected_cost_loss"><span class="n">expected_cost_loss</span></a><span class="p">,</span>
    <span class="n">response_method</span><span class="o">=</span><span class="s2">"predict_proba"</span><span class="p">,</span>
    <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fp_cost</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">fn_cost</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="n">cross_val_score</span><span class="p">(</span>
    <span class="n">pipeline</span><span class="p">,</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">scoring</span><span class="o">=</span><span class="n">scorer</span><span class="p">,</span>
    <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"model__fp_cost"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">"model__fn_cost"</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="use-case-specific-profit-and-cost-metrics">
<h4>Use-case specific profit and cost metrics<a class="headerlink" href="#use-case-specific-profit-and-cost-metrics" title="Link to this heading">#</a></h4>
<p>Empulse offers a wide range of profit and cost metrics that are tailored to specific use cases such as:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/metrics.html#customer-churn-metrics">customer churn</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/metrics.html#customer-acquisition-metrics">customer acquisition</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/metrics.html#credit-scoring-metrics">credit scoring</a>,</p></li>
<li><p>and fraud detection (coming soon).</p></li>
</ul>
<p>For other use cases, the package provides generic implementations for:</p>
<ul class="simple">
<li><p>the <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.cost_loss.html">cost loss</a>,</p></li>
<li><p>the <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.expected_cost_loss.html">expected cost loss</a>,</p></li>
<li><p>the <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.expected_log_cost_loss.html">expected log cost loss</a>,</p></li>
<li><p>the <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.savings_score.html">savings score</a>,</p></li>
<li><p>the <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.expected_savings_score.html">expected savings score</a>,</p></li>
<li><p>and the <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.max_profit_score.html">maximum profit score</a>.</p></li>
</ul>
</section>
<section id="build-your-own-profit-and-cost-metrics">
<h4>Build your own profit and cost metrics<a class="headerlink" href="#build-your-own-profit-and-cost-metrics" title="Link to this heading">#</a></h4>
<p>The <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.Metric.html">Metric</a> class allows
you to easily build your own profit and cost metrics.</p>
<p>First, you start to define the cost matrix
through the <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.CostMatrix.html">CostMatrix</a>
class.</p>
<p>A tiny example: suppose you’re building a spam filter.</p>
<ul class="simple">
<li><p>False positive (legit email marked as spam) costs 5, because you might miss something important</p></li>
<li><p>False negative (spam slips through) costs 1, because it wastes your time</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/metrics.html#module-empulse.metrics" title="empulse.metrics"><span class="nn">empulse.metrics</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.CostMatrix.html#empulse.metrics.CostMatrix" title="empulse.metrics.metric.cost_matrix.CostMatrix"><span class="n">CostMatrix</span></a>

<span class="n">cost_matrix</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.CostMatrix.html#empulse.metrics.CostMatrix" title="empulse.metrics.metric.cost_matrix.CostMatrix"><span class="n">CostMatrix</span></a><span class="p">()</span><span class="o">.</span><span class="n">add_fp_cost</span><span class="p">(</span><span class="s1">'fp'</span><span class="p">)</span><span class="o">.</span><span class="n">add_fn_cost</span><span class="p">(</span><span class="s1">'fn'</span><span class="p">)</span>
<span class="n">cost_matrix</span><span class="o">.</span><span class="n">alias</span><span class="p">({</span><span class="s1">'opportunity_cost'</span><span class="p">:</span> <span class="s1">'fp'</span><span class="p">,</span> <span class="s1">'time_wasted_cost'</span><span class="p">:</span> <span class="s1">'fn'</span><span class="p">})</span>
</pre></div>
</div>
<p>Now, you can define your own profit and cost metrics using different strategies.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.Cost.html">Cost</a>: lower is better.</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.Savings.html">Savings</a>: higher is better.</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.MaxProfit.html">MaxProfit</a>:
higher is better.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/metrics.html#module-empulse.metrics" title="empulse.metrics"><span class="nn">empulse.metrics</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Metric.html#empulse.metrics.Metric" title="empulse.metrics.metric.metric.Metric"><span class="n">Metric</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Cost.html#empulse.metrics.Cost" title="empulse.metrics.metric.cost_metric.Cost"><span class="n">Cost</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Savings.html#empulse.metrics.Savings" title="empulse.metrics.metric.savings_metric.Savings"><span class="n">Savings</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.MaxProfit.html#empulse.metrics.MaxProfit" title="empulse.metrics.metric.metric_strategies.MaxProfit"><span class="n">MaxProfit</span></a>

<a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Metric.html#empulse.metrics.Metric" title="empulse.metrics.metric.metric.Metric"><span class="n">expected_cost_loss</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Metric.html#empulse.metrics.Metric" title="empulse.metrics.metric.metric.Metric"><span class="n">Metric</span></a><span class="p">(</span><span class="n">cost_matrix</span><span class="o">=</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Cost.html#empulse.metrics.Cost" title="empulse.metrics.metric.cost_metric.Cost"><span class="n">Cost</span></a><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Metric.html#empulse.metrics.Metric" title="empulse.metrics.metric.metric.Metric"><span class="n">expected_savings_score</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Metric.html#empulse.metrics.Metric" title="empulse.metrics.metric.metric.Metric"><span class="n">Metric</span></a><span class="p">(</span><span class="n">cost_matrix</span><span class="o">=</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Savings.html#empulse.metrics.Savings" title="empulse.metrics.metric.savings_metric.Savings"><span class="n">Savings</span></a><span class="p">())</span>
<a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Metric.html#empulse.metrics.Metric" title="empulse.metrics.metric.metric.Metric"><span class="n">expected_max_profit_score</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Metric.html#empulse.metrics.Metric" title="empulse.metrics.metric.metric.Metric"><span class="n">Metric</span></a><span class="p">(</span><span class="n">cost_matrix</span><span class="o">=</span><span class="n">cost_matrix</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.MaxProfit.html#empulse.metrics.MaxProfit" title="empulse.metrics.metric.metric_strategies.MaxProfit"><span class="n">MaxProfit</span></a><span class="p">())</span>

<a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.Metric.html#empulse.metrics.Metric" title="empulse.metrics.metric.metric.Metric"><span class="n">expected_cost_loss</span></a><span class="p">(</span>
    <span class="n">y</span><span class="p">,</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">opportunity_cost</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">time_wasted_cost</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Your custom metric can also be optimized by the models:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/models.html#module-empulse.models" title="empulse.models"><span class="nn">empulse.models</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSBoostClassifier.html#empulse.models.CSBoostClassifier" title="empulse.models.cost_sensitive.csboost.CSBoostClassifier"><span class="n">CSBoostClassifier</span></a>

<a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSBoostClassifier.html#empulse.models.CSBoostClassifier" title="empulse.models.cost_sensitive.csboost.CSBoostClassifier"><span class="n">csboost</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSBoostClassifier.html#empulse.models.CSBoostClassifier" title="empulse.models.cost_sensitive.csboost.CSBoostClassifier"><span class="n">CSBoostClassifier</span></a><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">expected_cost_loss</span><span class="p">)</span>
<span class="n">csboost</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">opportunity_cost</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">time_wasted_cost</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Read more in the <a class="reference external" href="https://empulse.readthedocs.io/en/stable/guide/metrics/user_defined_value_metric.html">User Guide</a>.</p>
</section>
<section id="various-profit-driven-and-cost-sensitive-models">
<h4>Various profit-driven and cost-sensitive models<a class="headerlink" href="#various-profit-driven-and-cost-sensitive-models" title="Link to this heading">#</a></h4>
<p>Empulse provides a range of profit-driven and cost-sensitive models such as:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.CSLogitClassifier.html">CSLogitClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.CSBoostClassifier.html">CSBoostClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.CSTreeClassifier.html">CSTreeClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.CSForestClassifier.html">CSForestClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.CSBaggingClassifier.html">CSBaggingClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.B2BoostClassifier.html">B2BoostClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.RobustCSClassifier.html">RobustCSClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.ProfLogitClassifier.html">ProfLogitClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.BiasRelabelingClassifier.html">BiasRelabelingClassifier</a>,</p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.BiasResamplingClassifier.html">BiasResamplingClassifier</a>,</p></li>
<li><p>and <a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.BiasReweighingClassifier.html">BiasReweighingClassifier</a>.</p></li>
</ul>
<p>Each classifier tries to mimic the behaviour of sklearn’s classifiers with a cost-sensitive twist.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/models.html#module-empulse.models" title="empulse.models"><span class="nn">empulse.models</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSTreeClassifier.html#empulse.models.CSTreeClassifier" title="empulse.models.cost_sensitive.cstree.CSTreeClassifier"><span class="n">CSTreeClassifier</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.tree.html#module-sklearn.tree" title="sklearn.tree"><span class="nn">sklearn.tree</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier" title="sklearn.tree._classes.DecisionTreeClassifier"><span class="n">DecisionTreeClassifier</span></a>

<a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSTreeClassifier.html#empulse.models.CSTreeClassifier" title="empulse.models.cost_sensitive.cstree.CSTreeClassifier"><span class="n">cstree</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSTreeClassifier.html#empulse.models.CSTreeClassifier" title="empulse.models.cost_sensitive.cstree.CSTreeClassifier"><span class="n">CSTreeClassifier</span></a><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier" title="sklearn.tree._classes.DecisionTreeClassifier"><span class="n">dtree</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier" title="sklearn.tree._classes.DecisionTreeClassifier"><span class="n">DecisionTreeClassifier</span></a><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">cstree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fp_cost</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fn_cost</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dtree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="easy-passing-of-instance-dependent-costs">
<h4>Easy passing of instance-dependent costs<a class="headerlink" href="#easy-passing-of-instance-dependent-costs" title="Link to this heading">#</a></h4>
<p>Instance-dependent costs can easily be passed to the models through <a class="reference external" href="https://scikit-learn.org/stable/metadata_routing.html">metadata routing</a>.</p>
<p>For instance, the instance-dependent costs are passed dynamically to each fold of the cross-validation
through requesting the costs in the <code class="docutils literal notranslate"><span class="pre">set_fit_request</span></code> method of the model
and the <code class="docutils literal notranslate"><span class="pre">set_score_request</span></code> method of the scorer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/models.html#module-empulse.models" title="empulse.models"><span class="nn">empulse.models</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSTreeClassifier.html#empulse.models.CSTreeClassifier" title="empulse.models.cost_sensitive.cstree.CSTreeClassifier"><span class="n">CSTreeClassifier</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/metrics.html#module-empulse.metrics" title="empulse.metrics"><span class="nn">empulse.metrics</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.expected_cost_loss.html#empulse.metrics.expected_cost_loss" title="empulse.metrics.expected_cost_loss"><span class="n">expected_cost_loss</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.html#module-sklearn" title="sklearn"><span class="nn">sklearn</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="sklearn.set_config"><span class="n">set_config</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.datasets.html#module-sklearn.datasets" title="sklearn.datasets"><span class="nn">sklearn.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.model_selection.html#module-sklearn.model_selection" title="sklearn.model_selection"><span class="nn">sklearn.model_selection</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html#sklearn.model_selection.cross_val_score" title="sklearn.model_selection.cross_val_score"><span class="n">cross_val_score</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.metrics.html#module-sklearn.metrics" title="sklearn.metrics"><span class="nn">sklearn.metrics</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html#sklearn.metrics.make_scorer" title="sklearn.metrics.make_scorer"><span class="n">make_scorer</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.pipeline.html#module-sklearn.pipeline" title="sklearn.pipeline"><span class="nn">sklearn.pipeline</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">Pipeline</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.preprocessing.html#module-sklearn.preprocessing" title="sklearn.preprocessing"><span class="nn">sklearn.preprocessing</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a>

<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="sklearn.set_config"><span class="n">set_config</span></a><span class="p">(</span><span class="n">enable_metadata_routing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a><span class="p">()</span>
<span class="n">fp_cost</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">fn_cost</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">pipeline</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">Pipeline</span></a><span class="p">([</span>
    <span class="p">(</span><span class="s2">"scale"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a><span class="p">()),</span>
    <span class="p">(</span><span class="s2">"model"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSTreeClassifier.html#empulse.models.CSTreeClassifier" title="empulse.models.cost_sensitive.cstree.CSTreeClassifier"><span class="n">CSTreeClassifier</span></a><span class="p">()</span><span class="o">.</span><span class="n">set_fit_request</span><span class="p">(</span><span class="n">fp_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fn_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">scorer</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html#sklearn.metrics.make_scorer" title="sklearn.metrics.make_scorer"><span class="n">make_scorer</span></a><span class="p">(</span>
    <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.expected_cost_loss.html#empulse.metrics.expected_cost_loss" title="empulse.metrics.expected_cost_loss"><span class="n">expected_cost_loss</span></a><span class="p">,</span>
    <span class="n">response_method</span><span class="o">=</span><span class="s2">"predict_proba"</span><span class="p">,</span>
    <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">set_score_request</span><span class="p">(</span><span class="n">fp_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fn_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html#sklearn.model_selection.cross_val_score" title="sklearn.model_selection.cross_val_score"><span class="n">cross_val_score</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">pipeline</span></a><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scorer</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">"fp_cost"</span><span class="p">:</span> <span class="n">fp_cost</span><span class="p">,</span> <span class="s2">"fn_cost"</span><span class="p">:</span> <span class="n">fn_cost</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="cost-aware-resampling-and-relabeling">
<h4>Cost-aware resampling and relabeling<a class="headerlink" href="#cost-aware-resampling-and-relabeling" title="Link to this heading">#</a></h4>
<p>Empulse uses the <a class="reference external" href="https://imbalanced-learn.org/">imbalanced-learn</a>
package to provide cost-aware resampling and relabeling techniques:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.samplers.CostSensitiveSampler.html">CostSensitiveSampler</a></p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.samplers.BiasResampler.html">BiasResampler</a></p></li>
<li><p><a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.samplers.BiasRelabler.html">BiasRelabler</a></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/samplers.html#module-empulse.samplers" title="empulse.samplers"><span class="nn">empulse.samplers</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.samplers.CostSensitiveSampler.html#empulse.samplers.CostSensitiveSampler" title="empulse.samplers.cost_sampler.CostSensitiveSampler"><span class="n">CostSensitiveSampler</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.datasets.html#module-sklearn.datasets" title="sklearn.datasets"><span class="nn">sklearn.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="reference/generated/empulse.samplers.CostSensitiveSampler.html#empulse.samplers.CostSensitiveSampler" title="empulse.samplers.cost_sampler.CostSensitiveSampler"><span class="n">sampler</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.samplers.CostSensitiveSampler.html#empulse.samplers.CostSensitiveSampler" title="empulse.samplers.cost_sampler.CostSensitiveSampler"><span class="n">CostSensitiveSampler</span></a><span class="p">()</span>
<span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fp_cost</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fn_cost</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>They can be used in an imbalanced-learn pipeline:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/index.html#module-numpy" title="numpy"><span class="nn">numpy</span></a><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/samplers.html#module-empulse.samplers" title="empulse.samplers"><span class="nn">empulse.samplers</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.samplers.CostSensitiveSampler.html#empulse.samplers.CostSensitiveSampler" title="empulse.samplers.cost_sampler.CostSensitiveSampler"><span class="n">CostSensitiveSampler</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://imbalanced-learn.org/stable/references/pipeline.html#module-imblearn.pipeline" title="imblearn.pipeline"><span class="nn">imblearn.pipeline</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://imbalanced-learn.org/stable/references/generated/imblearn.pipeline.Pipeline.html#imblearn.pipeline.Pipeline" title="imblearn.pipeline.Pipeline"><span class="n">Pipeline</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.html#module-sklearn" title="sklearn"><span class="nn">sklearn</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="sklearn.set_config"><span class="n">set_config</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.datasets.html#module-sklearn.datasets" title="sklearn.datasets"><span class="nn">sklearn.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.preprocessing.html#module-sklearn.preprocessing" title="sklearn.preprocessing"><span class="nn">sklearn.preprocessing</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.linear_model.html#module-sklearn.linear_model" title="sklearn.linear_model"><span class="nn">sklearn.linear_model</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model._logistic.LogisticRegression"><span class="n">LogisticRegression</span></a>

<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html#sklearn.set_config" title="sklearn.set_config"><span class="n">set_config</span></a><span class="p">(</span><span class="n">enable_metadata_routing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a><span class="p">()</span>
<span class="n">fp_cost</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">fn_cost</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.rand.html#numpy.random.rand" title="numpy.random.rand"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span></a><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://imbalanced-learn.org/stable/references/generated/imblearn.pipeline.Pipeline.html#imblearn.pipeline.Pipeline" title="imblearn.pipeline.Pipeline"><span class="n">pipeline</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://imbalanced-learn.org/stable/references/generated/imblearn.pipeline.Pipeline.html#imblearn.pipeline.Pipeline" title="imblearn.pipeline.Pipeline"><span class="n">Pipeline</span></a><span class="p">([</span>
    <span class="p">(</span><span class="s2">"scaler"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a><span class="p">()),</span>
    <span class="p">(</span><span class="s2">"sampler"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.samplers.CostSensitiveSampler.html#empulse.samplers.CostSensitiveSampler" title="empulse.samplers.cost_sampler.CostSensitiveSampler"><span class="n">CostSensitiveSampler</span></a><span class="p">()</span><span class="o">.</span><span class="n">set_fit_resample_request</span><span class="p">(</span><span class="n">fp_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fn_cost</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
    <span class="p">(</span><span class="s2">"model"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model._logistic.LogisticRegression"><span class="n">LogisticRegression</span></a><span class="p">())</span>
<span class="p">])</span>

<a class="sphinx-codeautolink-a" href="https://imbalanced-learn.org/stable/references/generated/imblearn.pipeline.Pipeline.html#imblearn.pipeline.Pipeline.fit" title="imblearn.pipeline.Pipeline.fit"><span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">fp_cost</span><span class="o">=</span><span class="n">fp_cost</span><span class="p">,</span> <span class="n">fn_cost</span><span class="o">=</span><span class="n">fn_cost</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="find-the-optimal-decision-threshold">
<h4>Find the optimal decision threshold<a class="headerlink" href="#find-the-optimal-decision-threshold" title="Link to this heading">#</a></h4>
<p>Empulse provides the
<a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.models.CSThresholdClassifier.html"><code class="docutils literal notranslate"><span class="pre">CSThresholdClassifier</span></code></a>
which allows you to find the optimal decision threshold for a given cost matrix to minimize the expected cost loss.</p>
<p>The meta-estimator changes the <code class="docutils literal notranslate"><span class="pre">predict</span></code> method of the base estimator to predict the class with the lowest expected cost.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/models.html#module-empulse.models" title="empulse.models"><span class="nn">empulse.models</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSThresholdClassifier.html#empulse.models.CSThresholdClassifier" title="empulse.models.cost_sensitive.cost_threshold.CSThresholdClassifier"><span class="n">CSThresholdClassifier</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.datasets.html#module-sklearn.datasets" title="sklearn.datasets"><span class="nn">sklearn.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.linear_model.html#module-sklearn.linear_model" title="sklearn.linear_model"><span class="nn">sklearn.linear_model</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model._logistic.LogisticRegression"><span class="n">LogisticRegression</span></a>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSThresholdClassifier.html#empulse.models.CSThresholdClassifier" title="empulse.models.cost_sensitive.cost_threshold.CSThresholdClassifier"><span class="n">model</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSThresholdClassifier.html#empulse.models.CSThresholdClassifier" title="empulse.models.cost_sensitive.cost_threshold.CSThresholdClassifier"><span class="n">CSThresholdClassifier</span></a><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model._logistic.LogisticRegression"><span class="n">LogisticRegression</span></a><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">fp_cost</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fn_cost</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Metrics like the maximum profit score conveniently return the optimal target threshold.
For example, the Expected Maximum Profit measure for customer churn (EMPC)
tells you what fraction of the customer base should be targeted to maximize profit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/metrics.html#module-empulse.metrics" title="empulse.metrics"><span class="nn">empulse.metrics</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.empc.html#empulse.metrics.empc" title="empulse.metrics.empc"><span class="n">empc</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.datasets.html#module-sklearn.datasets" title="sklearn.datasets"><span class="nn">sklearn.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.linear_model.html#module-sklearn.linear_model" title="sklearn.linear_model"><span class="nn">sklearn.linear_model</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model._logistic.LogisticRegression"><span class="n">LogisticRegression</span></a>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><span class="n">make_classification</span></a><span class="p">()</span>
<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model._logistic.LogisticRegression"><span class="n">model</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression" title="sklearn.linear_model._logistic.LogisticRegression"><span class="n">LogisticRegression</span></a><span class="p">()</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">score</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.empc.html#empulse.metrics.empc" title="empulse.metrics.empc"><span class="n">empc</span></a><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">clv</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>This score can then be converted to a decision threshold by using the
<a class="reference external" href="https://empulse.readthedocs.io/en/stable/reference/generated/empulse.metrics.classification_threshold.html"><code class="docutils literal notranslate"><span class="pre">classification_threshold</span></code></a>
function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/metrics.html#module-empulse.metrics" title="empulse.metrics"><span class="nn">empulse.metrics</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.classification_threshold.html#empulse.metrics.classification_threshold" title="empulse.metrics.classification_threshold"><span class="n">classification_threshold</span></a>

<span class="n">decision_threshold</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.metrics.classification_threshold.html#empulse.metrics.classification_threshold" title="empulse.metrics.classification_threshold"><span class="n">classification_threshold</span></a><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">customer_threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>
</pre></div>
</div>
<p>This can then be combined with sci-kit learn’s
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.FixedThresholdClassifier.html"><code class="docutils literal notranslate"><span class="pre">FixedThresholdClassifier</span></code></a>
to create a model that predicts the class with the highest expected profit.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.model_selection.html#module-sklearn.model_selection" title="sklearn.model_selection"><span class="nn">sklearn.model_selection</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.FixedThresholdClassifier.html#sklearn.model_selection.FixedThresholdClassifier" title="sklearn.model_selection._classification_threshold.FixedThresholdClassifier"><span class="n">FixedThresholdClassifier</span></a>

<span class="n">model</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.FixedThresholdClassifier.html#sklearn.model_selection.FixedThresholdClassifier" title="sklearn.model_selection._classification_threshold.FixedThresholdClassifier"><span class="n">FixedThresholdClassifier</span></a><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.FixedThresholdClassifier.html#sklearn.model_selection.FixedThresholdClassifier" title="sklearn.model_selection._classification_threshold.FixedThresholdClassifier"><span class="n">model</span></a><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">decision_threshold</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="easy-access-to-real-world-datasets-for-benchmarking">
<h4>Easy access to real-world datasets for benchmarking<a class="headerlink" href="#easy-access-to-real-world-datasets-for-benchmarking" title="Link to this heading">#</a></h4>
<p>Empulse provides easy access to real-world datasets for benchmarking cost-sensitive models.</p>
<p>Each dataset returns the features, the target, and the instance-dependent costs, ready to use in a cost-sensitive model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/datasets.html#module-empulse.datasets" title="empulse.datasets"><span class="nn">empulse.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.datasets.load_give_me_some_credit.html#empulse.datasets.load_give_me_some_credit" title="empulse.datasets.load_give_me_some_credit"><span class="n">load_give_me_some_credit</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="reference/models.html#module-empulse.models" title="empulse.models"><span class="nn">empulse.models</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSLogitClassifier.html#empulse.models.CSLogitClassifier" title="empulse.models.cost_sensitive.cslogit.CSLogitClassifier"><span class="n">CSLogitClassifier</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.pipeline.html#module-sklearn.pipeline" title="sklearn.pipeline"><span class="nn">sklearn.pipeline</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">Pipeline</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.preprocessing.html#module-sklearn.preprocessing" title="sklearn.preprocessing"><span class="nn">sklearn.preprocessing</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tp_cost</span><span class="p">,</span> <span class="n">fp_cost</span><span class="p">,</span> <span class="n">tn_cost</span><span class="p">,</span> <span class="n">fn_cost</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.datasets.load_give_me_some_credit.html#empulse.datasets.load_give_me_some_credit" title="empulse.datasets.load_give_me_some_credit"><span class="n">load_give_me_some_credit</span></a><span class="p">(</span><span class="n">return_X_y_costs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">pipeline</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">Pipeline</span></a><span class="p">([</span>
    <span class="p">(</span><span class="s1">'scaler'</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a><span class="p">()),</span>
    <span class="p">(</span><span class="s1">'model'</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="reference/generated/empulse.models.CSLogitClassifier.html#empulse.models.CSLogitClassifier" title="empulse.models.cost_sensitive.cslogit.CSLogitClassifier"><span class="n">CSLogitClassifier</span></a><span class="p">())</span>
<span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline.fit" title="sklearn.pipeline.Pipeline.fit"><span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">model__tp_cost</span><span class="o">=</span><span class="n">tp_cost</span><span class="p">,</span>
    <span class="n">model__fp_cost</span><span class="o">=</span><span class="n">fp_cost</span><span class="p">,</span>
    <span class="n">model__tn_cost</span><span class="o">=</span><span class="n">tn_cost</span><span class="p">,</span>
    <span class="n">model__fn_cost</span><span class="o">=</span><span class="n">fn_cost</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<div class="toctree-wrapper compound">
</div>
</section>
</section>
</article>
<footer class="bd-footer-article">
<div class="footer-article-items footer-article__inner">
<div class="footer-article-item">
<div class="prev-next-area">
<a class="right-next" href="guide.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">User Guide</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div></div>
</div>
</footer>
</div>
<dialog id="pst-secondary-sidebar-modal"></dialog>
<div class="bd-sidebar-secondary bd-toc" id="pst-secondary-sidebar"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage" id="pst-page-navigation-heading-2">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav aria-labelledby="pst-page-navigation-heading-2" class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-can-you-do-with-empulse">What can you do with Empulse?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#features">Features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#take-the-tour">Take the tour</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ready-to-use-out-of-the-box-with-scikit-learn">Ready to use out of the box with scikit-learn</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#pipelines">Pipelines</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation">Cross-validation</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grid-search">Grid search</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case-specific-profit-and-cost-metrics">Use-case specific profit and cost metrics</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#build-your-own-profit-and-cost-metrics">Build your own profit and cost metrics</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#various-profit-driven-and-cost-sensitive-models">Various profit-driven and cost-sensitive models</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#easy-passing-of-instance-dependent-costs">Easy passing of instance-dependent costs</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cost-aware-resampling-and-relabeling">Cost-aware resampling and relabeling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#find-the-optimal-decision-threshold">Find the optimal decision threshold</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#easy-access-to-real-world-datasets-for-benchmarking">Easy access to real-world datasets for benchmarking</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script defer="" src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer="" src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>
<footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
<div class="footer-items__start">
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2024 - 2025, Shimanto Rahman (MIT License).
      <br/>
</p>
</div>
</div>
</div>
</footer>
</body>
</html>