
<!DOCTYPE html>

<html data-content_root="../../" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>5.1. Bank Telemarketing Upsell Campaign — Empulse 0.10.4 documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
<!--
    this give us a css class that will be invisible only if js is disabled
  -->
<noscript>
<style>
      .pst-js-only { display: none !important; }

    </style>
</noscript>
<!-- Loaded before other Sphinx assets -->
<link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet"/>
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet"/>
<link href="../../_static/pygments.css?v=8f2a1f02" rel="stylesheet" type="text/css"/>
<link href="../../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-codeautolink.css?v=b2176991" rel="stylesheet" type="text/css"/>
<link href="../../_static/css/custom.css?v=a1165396" rel="stylesheet" type="text/css"/>
<!-- So that users can add custom icons -->
<script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" rel="preload"/>
<link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" rel="preload"/>
<script src="../../_static/documentation_options.js?v=7e173fe4"></script>
<script src="../../_static/doctools.js?v=9bcbadda"></script>
<script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../../_static/copybutton.js?v=f281be69"></script>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'guide/datasets/bank_telemarketing';</script>
<script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://empulse.readthedocs.io/en/latest/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.10.4';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
<script src="../../_static/js/custom-icon.js?v=d6c5daaf"></script>
<link href="../../_static/favicon.ico" rel="icon"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="churn_tv_subscriptions.html" rel="next" title="5.2. Churn in a TV Subscription Company"/>
<link href="../datasets_guide.html" rel="prev" title="5. Datasets"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
<meta content="" name="docsearch:version"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<div class="skip-link d-print-none" id="pst-skip-link"><a href="#main-content">Skip to main content</a></div>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>Back to top</button>
<dialog id="pst-search-dialog">
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search the docs ..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" name="q" placeholder="Search the docs ..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</dialog>
<div class="pst-async-banner-revealer d-none">
<aside aria-label="Version warning" class="d-none d-print-none" id="bd-header-version-warning"></aside>
</div>
<header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
<button aria-label="Site navigation" class="pst-navbar-icon sidebar-toggle primary-toggle">
<span class="fa-solid fa-bars"></span>
</button>
<div class="navbar-header-items__start">
<div class="navbar-item">
<a class="navbar-brand logo" href="../../index.html">
<img alt="empulse homepage" class="logo__image only-light" src="../../_static/empulse_logo_light.png"/>
<img alt="empulse homepage" class="logo__image only-dark pst-js-only" src="../../_static/empulse_logo_dark.png"/>
</a></div>
</div>
<div class="navbar-header-items">
<div class="me-auto navbar-header-items__center">
<div class="navbar-item">
<nav>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../../guide.html">
    User Guide
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../api.html">
    API Reference
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../project_info.html">
    Project Information
  </a>
</li>
</ul>
</nav></div>
</div>
<div class="navbar-header-items__end">
<div class="navbar-item navbar-persistent--container">
<button aria-label="Search" class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
</div>
<div class="navbar-item">
<button aria-label="Color mode" class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" data-bs-placement="bottom" data-bs-title="Color mode" data-bs-toggle="tooltip">
<i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light" title="Light"></i>
<i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark" title="Dark"></i>
<i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto" title="System Settings"></i>
</button></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links">
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/ShimantoRahman/empulse" rel="noopener" target="_blank" title="GitHub"><i aria-hidden="true" class="fa-brands fa-github fa-lg"></i>
<span class="sr-only">GitHub</span></a>
</li>
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/empulse/" rel="noopener" target="_blank" title="PyPI"><i aria-hidden="true" class="fa-custom fa-pypi fa-lg"></i>
<span class="sr-only">PyPI</span></a>
</li>
</ul></div>
<div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
<button aria-controls="pst-version-switcher-list-2" aria-haspopup="listbox" aria-label="Version switcher list" class="version-switcher__button btn btn-sm dropdown-toggle" data-bs-toggle="dropdown" id="pst-version-switcher-button-2" type="button">
    Choose version  <!-- this text may get changed later by javascript -->
<span class="caret"></span>
</button>
<div aria-labelledby="pst-version-switcher-button-2" class="version-switcher__menu dropdown-menu list-group-flush py-0" id="pst-version-switcher-list-2" role="listbox">
<!-- dropdown will be populated by javascript on page load -->
</div>
</div></div>
</div>
</div>
<div class="navbar-persistent--mobile">
<button aria-label="Search" class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
</div>
<button aria-label="On this page" class="pst-navbar-icon sidebar-toggle secondary-toggle">
<span class="fa-solid fa-outdent"></span>
</button>
</div>
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<dialog id="pst-primary-sidebar-modal"></dialog>
<div class="bd-sidebar-primary bd-sidebar" id="pst-primary-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-item">
<nav>
<ul class="bd-navbar-elements navbar-nav">
<li class="nav-item current active">
<a class="nav-link nav-internal" href="../../guide.html">
    User Guide
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../api.html">
    API Reference
  </a>
</li>
<li class="nav-item">
<a class="nav-link nav-internal" href="../../project_info.html">
    Project Information
  </a>
</li>
</ul>
</nav></div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-item">
<button aria-label="Color mode" class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" data-bs-placement="bottom" data-bs-title="Color mode" data-bs-toggle="tooltip">
<i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light" title="Light"></i>
<i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark" title="Dark"></i>
<i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto" title="System Settings"></i>
</button></div>
<div class="navbar-item"><ul aria-label="Icon Links" class="navbar-icon-links">
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/ShimantoRahman/empulse" rel="noopener" target="_blank" title="GitHub"><i aria-hidden="true" class="fa-brands fa-github fa-lg"></i>
<span class="sr-only">GitHub</span></a>
</li>
<li class="nav-item">
<a class="nav-link pst-navbar-icon" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://pypi.org/project/empulse/" rel="noopener" target="_blank" title="PyPI"><i aria-hidden="true" class="fa-custom fa-pypi fa-lg"></i>
<span class="sr-only">PyPI</span></a>
</li>
</ul></div>
<div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
<button aria-controls="pst-version-switcher-list-3" aria-haspopup="listbox" aria-label="Version switcher list" class="version-switcher__button btn btn-sm dropdown-toggle" data-bs-toggle="dropdown" id="pst-version-switcher-button-3" type="button">
    Choose version  <!-- this text may get changed later by javascript -->
<span class="caret"></span>
</button>
<div aria-labelledby="pst-version-switcher-button-3" class="version-switcher__menu dropdown-menu list-group-flush py-0" id="pst-version-switcher-list-3" role="listbox">
<!-- dropdown will be populated by javascript on page load -->
</div>
</div></div>
</div>
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<nav aria-label="Section Navigation" class="bd-docs-nav bd-links">
<p aria-level="1" class="bd-links__title" role="heading">Section Navigation</p>
<div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../metrics_guide.html">1. Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../metrics/choosing_metric.html">1.1. Choosing the right metric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/user_defined_value_metric.html">1.2. Define your own cost-sensitive or value metric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/metric_class_in_model.html">1.3. Use your custom metric inside a model</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../models_guide.html">2. Cost-sensitive and Value-driven models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/cslogit.html">2.1. Cost-Sensitive Logistic Regression (CSLogit)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/csboost.html">2.2. Cost-Sensitive Gradient Boosting (CSBoost &amp; B2Boost)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/cost_functions.html">2.3. Boosting Algorithms Custom Cost Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/robustcs.html">2.4. Robust Cost-Sensitive Classification (RobustCS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/proflogit.html">2.5. Profit-Driven Logistic Regression (ProfLogit)</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../preprocessing_guide.html">3. Model-Independent Preprocessing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/bias_mitigation.html">3.1. Bias Mitigation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preprocessing/cost_sampling.html">3.2. Cost-Proportionate Sampling</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../instance_based_cv.html">4. Cross-Validation with Instance-dependent Costs</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../datasets_guide.html">5. Datasets</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">5.1. Bank Telemarketing Upsell Campaign</a></li>
<li class="toctree-l2"><a class="reference internal" href="churn_tv_subscriptions.html">5.2. Churn in a TV Subscription Company</a></li>
<li class="toctree-l2"><a class="reference internal" href="credit_scoring_pakdd.html">5.3. Credit Risk Assessment on a Private Label Credit Card Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="give_me_some_credit.html">5.4. 2011 Kaggle competition Give Me Some Credit</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
</div>
<main class="bd-main" id="main-content" role="main">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item">
<nav aria-label="Breadcrumb" class="d-print-none">
<ul class="bd-breadcrumbs">
<li class="breadcrumb-item breadcrumb-home">
<a aria-label="Home" class="nav-link" href="../../index.html">
<i class="fa-solid fa-home"></i>
</a>
</li>
<li class="breadcrumb-item"><a class="nav-link" href="../../guide.html">User Guide</a></li>
<li class="breadcrumb-item"><a class="nav-link" href="../datasets_guide.html"><span class="section-number">5. </span>Datasets</a></li>
<li aria-current="page" class="breadcrumb-item active"><span class="ellipsis"><span class="section-number">5.1. </span>Bank Telemarketing Upsell Campaign</span></li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article">
<section id="bank-telemarketing-upsell-campaign">
<span id="upsell-bank-telemarketing"></span><h1><span class="section-number">5.1. </span>Bank Telemarketing Upsell Campaign<a class="headerlink" href="#bank-telemarketing-upsell-campaign" title="Link to this heading">#</a></h1>
<section id="summary">
<h2><span class="section-number">5.1.1. </span>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>This dataset is related to a direct marketing campaigns (phone calls) of a Portuguese banking institution.
The marketing campaigns were based on phone calls.
Often, more than one contact to the same client was required,
in order to access if the product (bank term deposit) would be or not subscribed.</p>
<p>Features recorded before the contact event are removed from the original dataset <a class="footnote-reference brackets" href="#id5" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> to avoid data leakage.
Only clients with a positive balance are considered, since clients in debt are not eligible for term deposits.</p>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td><p>Classes</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Subscribers</p></td>
<td><p>4787</p></td>
</tr>
<tr class="row-odd"><td><p>Non-subscribers</p></td>
<td><p>33144</p></td>
</tr>
<tr class="row-even"><td><p>Samples</p></td>
<td><p>37931</p></td>
</tr>
<tr class="row-odd"><td><p>Features</p></td>
<td><p>10</p></td>
</tr>
</tbody>
</table>
</div>
<p>Other relevant information can be found in <a class="footnote-reference brackets" href="#id6" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and <a class="footnote-reference brackets" href="#id7" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
</section>
<section id="using-the-dataset">
<h2><span class="section-number">5.1.2. </span>Using the Dataset<a class="headerlink" href="#using-the-dataset" title="Link to this heading">#</a></h2>
<p>The dataset can be loaded through the <a class="reference internal" href="../../reference/generated/empulse.datasets.load_upsell_bank_telemarketing.html#empulse.datasets.load_upsell_bank_telemarketing" title="empulse.datasets.load_upsell_bank_telemarketing"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_upsell_bank_telemarketing</span></code></a> function.
This returns a <a class="reference internal" href="../../reference/generated/empulse.datasets.Dataset.html#empulse.datasets.Dataset" title="empulse.datasets.Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a> object with the following attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>: the feature matrix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target</span></code>: the target vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tp_cost</span></code>: the cost of a true positive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fp_cost</span></code>: the cost of a false positive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fn_cost</span></code>: the cost of a false negative</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tn_cost</span></code>: the cost of a true negative</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feature_names</span></code>: the feature names</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_names</span></code>: the target names</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DESCR</span></code>: the full description of the dataset</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../../reference/datasets.html#module-empulse.datasets" title="empulse.datasets"><span class="nn">empulse.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../reference/generated/empulse.datasets.load_upsell_bank_telemarketing.html#empulse.datasets.load_upsell_bank_telemarketing" title="empulse.datasets.load_upsell_bank_telemarketing"><span class="n">load_upsell_bank_telemarketing</span></a>

<span class="n">dataset</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../reference/generated/empulse.datasets.load_upsell_bank_telemarketing.html#empulse.datasets.load_upsell_bank_telemarketing" title="empulse.datasets.load_upsell_bank_telemarketing"><span class="n">load_upsell_bank_telemarketing</span></a><span class="p">()</span>
</pre></div>
</div>
<p>Alternatively, the load function can also return the features, target, and costs separately,
by setting <code class="docutils literal notranslate"><span class="pre">return_X_y_costs=True</span></code>.
Additionally, you can specify that you want the output in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> format,
by setting <code class="docutils literal notranslate"><span class="pre">as_frame=True</span></code>.</p>
<p>The following code snippet demonstrates how to load the dataset and fit a model using the
<a class="reference internal" href="../../reference/generated/empulse.models.CSLogitClassifier.html#empulse.models.CSLogitClassifier" title="empulse.models.CSLogitClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">CSLogitClassifier</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../../reference/datasets.html#module-empulse.datasets" title="empulse.datasets"><span class="nn">empulse.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../reference/generated/empulse.datasets.load_upsell_bank_telemarketing.html#empulse.datasets.load_upsell_bank_telemarketing" title="empulse.datasets.load_upsell_bank_telemarketing"><span class="n">load_upsell_bank_telemarketing</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../../reference/models.html#module-empulse.models" title="empulse.models"><span class="nn">empulse.models</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../reference/generated/empulse.models.CSLogitClassifier.html#empulse.models.CSLogitClassifier" title="empulse.models.cost_sensitive.cslogit.CSLogitClassifier"><span class="n">CSLogitClassifier</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.compose.html#module-sklearn.compose" title="sklearn.compose"><span class="nn">sklearn.compose</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html#sklearn.compose.ColumnTransformer" title="sklearn.compose._column_transformer.ColumnTransformer"><span class="n">ColumnTransformer</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.pipeline.html#module-sklearn.pipeline" title="sklearn.pipeline"><span class="nn">sklearn.pipeline</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">Pipeline</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/api/sklearn.preprocessing.html#module-sklearn.preprocessing" title="sklearn.preprocessing"><span class="nn">sklearn.preprocessing</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.TargetEncoder.html#sklearn.preprocessing.TargetEncoder" title="sklearn.preprocessing._target_encoder.TargetEncoder"><span class="n">TargetEncoder</span></a>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tp_cost</span><span class="p">,</span> <span class="n">fp_cost</span><span class="p">,</span> <span class="n">fn_cost</span><span class="p">,</span> <span class="n">tn_cost</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../reference/generated/empulse.datasets.load_upsell_bank_telemarketing.html#empulse.datasets.load_upsell_bank_telemarketing" title="empulse.datasets.load_upsell_bank_telemarketing"><span class="n">load_upsell_bank_telemarketing</span></a><span class="p">(</span>
    <span class="n">return_X_y_costs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">pipeline</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline" title="sklearn.pipeline.Pipeline"><span class="n">Pipeline</span></a><span class="p">([</span>
    <span class="p">(</span><span class="s1">'preprocessor'</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html#sklearn.compose.ColumnTransformer" title="sklearn.compose._column_transformer.ColumnTransformer"><span class="n">ColumnTransformer</span></a><span class="p">([</span>
        <span class="p">(</span><span class="s1">'num'</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html#sklearn.preprocessing.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="n">StandardScaler</span></a><span class="p">(),</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">'number'</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">'cat'</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.TargetEncoder.html#sklearn.preprocessing.TargetEncoder" title="sklearn.preprocessing._target_encoder.TargetEncoder"><span class="n">TargetEncoder</span></a><span class="p">(),</span> <span class="n">X</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">'category'</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="p">])),</span>
    <span class="p">(</span><span class="s1">'model'</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../../reference/generated/empulse.models.CSLogitClassifier.html#empulse.models.CSLogitClassifier" title="empulse.models.cost_sensitive.cslogit.CSLogitClassifier"><span class="n">CSLogitClassifier</span></a><span class="p">())</span>
<span class="p">])</span>
<a class="sphinx-codeautolink-a" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline.fit" title="sklearn.pipeline.Pipeline.fit"><span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">y</span><span class="p">,</span>
    <span class="n">model__tp_cost</span><span class="o">=</span><span class="n">tp_cost</span><span class="p">,</span>
    <span class="n">model__fp_cost</span><span class="o">=</span><span class="n">fp_cost</span><span class="p">,</span>
    <span class="n">model__fn_cost</span><span class="o">=</span><span class="n">fn_cost</span><span class="p">,</span>
    <span class="n">model__tn_cost</span><span class="o">=</span><span class="n">tn_cost</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cost-matrix">
<h2><span class="section-number">5.1.3. </span>Cost Matrix<a class="headerlink" href="#cost-matrix" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<tbody>
<tr class="row-odd"><td></td>
<td><p>Actual positive <span class="math notranslate nohighlight">\(y_i = 1\)</span></p></td>
<td><p>Actual negative <span class="math notranslate nohighlight">\(y_i = 0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Predicted positive <span class="math notranslate nohighlight">\(\hat{y}_i = 1\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tp_cost</span></code> <span class="math notranslate nohighlight">\(= c\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fp_cost</span></code> <span class="math notranslate nohighlight">\(= c\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Predicted negative <span class="math notranslate nohighlight">\(\hat{y}_i = 0\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fn_cost</span></code> <span class="math notranslate nohighlight">\(= r \cdot d_i \cdot b_i\)</span></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tn_cost</span></code> <span class="math notranslate nohighlight">\(= 0\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="simple">
<dt>with</dt><dd><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c\)</span> : cost of contacting the client</p></li>
<li><p><span class="math notranslate nohighlight">\(r\)</span> : interest rate of the term deposit</p></li>
<li><p><span class="math notranslate nohighlight">\(d_i\)</span> : fraction of the client’s balance that is deposited in the term deposit</p></li>
<li><p><span class="math notranslate nohighlight">\(b_i\)</span> : client’s balance</p></li>
</ul>
</dd>
</dl>
<p>Using default parameters, it is assumed that <span class="math notranslate nohighlight">\(c = 1\)</span>, <span class="math notranslate nohighlight">\(r = 0.02463333\)</span>, <span class="math notranslate nohighlight">\(d_i = 0.25\)</span> for all clients.
The default parameters are based on <a class="footnote-reference brackets" href="#id8" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
<p>These assumptions can be changed by passing your own values to the
<a class="reference internal" href="../../reference/generated/empulse.datasets.load_upsell_bank_telemarketing.html#empulse.datasets.load_upsell_bank_telemarketing" title="empulse.datasets.load_upsell_bank_telemarketing"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_upsell_bank_telemarketing</span></code></a> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../../reference/datasets.html#module-empulse.datasets" title="empulse.datasets"><span class="nn">empulse.datasets</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../../reference/generated/empulse.datasets.load_upsell_bank_telemarketing.html#empulse.datasets.load_upsell_bank_telemarketing" title="empulse.datasets.load_upsell_bank_telemarketing"><span class="n">load_upsell_bank_telemarketing</span></a>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tp_cost</span><span class="p">,</span> <span class="n">fp_cost</span><span class="p">,</span> <span class="n">fn_cost</span><span class="p">,</span> <span class="n">tn_cost</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../../reference/generated/empulse.datasets.load_upsell_bank_telemarketing.html#empulse.datasets.load_upsell_bank_telemarketing" title="empulse.datasets.load_upsell_bank_telemarketing"><span class="n">load_upsell_bank_telemarketing</span></a><span class="p">(</span>
    <span class="n">return_X_y_costs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">interest_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="n">term_deposit_fraction</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span>
    <span class="n">contact_cost</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="data-description">
<h2><span class="section-number">5.1.4. </span>Data Description<a class="headerlink" href="#data-description" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Variable Name</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>age</p></td>
<td><p>Age of the client</p></td>
<td><p>numeric</p></td>
</tr>
<tr class="row-odd"><td><p>balance</p></td>
<td><p>Average yearly balance</p></td>
<td><p>numeric</p></td>
</tr>
<tr class="row-even"><td><p>previous</p></td>
<td><p>Number of contacts performed before this campaign and for this client</p></td>
<td><p>numeric</p></td>
</tr>
<tr class="row-odd"><td><p>job</p></td>
<td><p>Type of job (e.g., ‘admin.’, ‘blue-collar’, ‘entrepreneur’, etc.)</p></td>
<td><p>categorical</p></td>
</tr>
<tr class="row-even"><td><p>marital</p></td>
<td><p>Marital status (‘divorced’, ‘married’, ‘single’)</p></td>
<td><p>categorical</p></td>
</tr>
<tr class="row-odd"><td><p>education</p></td>
<td><p>Education level (‘primary’, ‘secondary’, ‘tertiary’, ‘unknown’)</p></td>
<td><p>categorical</p></td>
</tr>
<tr class="row-even"><td><p>has_credit_in_default</p></td>
<td><p>Has credit in default? (‘yes’ = 1, ‘no’ = 0)</p></td>
<td><p>binary</p></td>
</tr>
<tr class="row-odd"><td><p>has_housing_loan</p></td>
<td><p>Has housing loan? (‘yes’ = 1, ‘no’ = 0)</p></td>
<td><p>binary</p></td>
</tr>
<tr class="row-even"><td><p>has_personal_loan</p></td>
<td><p>Has personal loan? (‘yes’ = 1, ‘no’ = 0)</p></td>
<td><p>binary</p></td>
</tr>
<tr class="row-odd"><td><p>previous_outcome</p></td>
<td><p>Outcome of the previous marketing campaign (‘success’, ‘failure’, ‘other’, ‘unknown’)</p></td>
<td><p>categorical</p></td>
</tr>
<tr class="row-even"><td><p>subscribed</p></td>
<td><p>Has the client subscribed a term deposit? (‘yes’ = 1, ‘no’ = 0)</p></td>
<td><p>binary</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="references">
<h2><span class="section-number">5.1.5. </span>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id1" role="doc-backlink">1</a><span class="fn-bracket">]</span></span>
<p>Moro, S., Rita, P., &amp; Cortez, P. (2014).
Bank Marketing [Dataset]. UCI Machine Learning Repository. <a class="reference external" href="https://doi.org/10.24432/C5K306">https://doi.org/10.24432/C5K306</a>.</p>
</aside>
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id2" role="doc-backlink">2</a><span class="fn-bracket">]</span></span>
<p>Moro, S., Cortez, P., &amp; Rita, P. (2014).
A data-driven approach to predict the success of bank telemarketing. Decision Support Systems, 62, 22-31.</p>
</aside>
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id3" role="doc-backlink">3</a><span class="fn-bracket">]</span></span>
<p>S. Moro, R. Laureano and P. Cortez.
Using Data Mining for Bank Direct Marketing: An Application of the CRISP-DM Methodology.
In P. Novais et al. (Eds.),
Proceedings of the European Simulation and Modelling Conference
- ESM’2011, pp. 117-121, Guimaraes, Portugal, October, 2011. EUROSIS. [bank.zip]</p>
</aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a href="#id4" role="doc-backlink">4</a><span class="fn-bracket">]</span></span>
<p>A. Correa Bahnsen, A. Stojanovic, D.Aouada, B, Ottersten,
<a class="reference external" href="http://albahnsen.com/files/%20Improving%20Credit%20Card%20Fraud%20Detection%20by%20using%20Calibrated%20Probabilities%20-%20Publish.pdf">“Improving Credit Card Fraud Detection with Calibrated Probabilities”</a>,
in Proceedings of the fourteenth SIAM International Conference on Data Mining,
677-685, 2014.</p>
</aside>
</aside>
</section>
</section>
</article>
<footer class="bd-footer-article">
<div class="footer-article-items footer-article__inner">
<div class="footer-article-item">
<div class="prev-next-area">
<a class="left-prev" href="../datasets_guide.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title"><span class="section-number">5. </span>Datasets</p>
</div>
</a>
<a class="right-next" href="churn_tv_subscriptions.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title"><span class="section-number">5.2. </span>Churn in a TV Subscription Company</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div></div>
</div>
</footer>
</div>
<dialog id="pst-secondary-sidebar-modal"></dialog>
<div class="bd-sidebar-secondary bd-toc" id="pst-secondary-sidebar"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage" id="pst-page-navigation-heading-2">
<i class="fa-solid fa-list"></i> On this page
  </div>
<nav aria-labelledby="pst-page-navigation-heading-2" class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">5.1.1. Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-dataset">5.1.2. Using the Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cost-matrix">5.1.3. Cost Matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-description">5.1.4. Data Description</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">5.1.5. References</a></li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script defer="" src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer="" src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>
<footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
<div class="footer-items__start">
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2024 - 2025, Shimanto Rahman (MIT License).
      <br/>
</p>
</div>
</div>
</div>
</footer>
</body>
</html>